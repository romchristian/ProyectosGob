<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:p="http://primefaces.org/ui"
      xmlns:c="http://xmlns.jcp.org/jsp/jstl/core">


    <ui:composition template="/template.xhtml">
        <f:metadata>
            <f:viewAction action="#{proyectoController.prepareCreate()}"/>
        </f:metadata>


        <ui:define name="title">
            <h:outputText value="Inicio"></h:outputText>
        </ui:define>

        <ui:define name="body">
            <style>

                * .dataList{
                    margin: 5px;
                }
                .hoja{
                    height: 100%;
                    width: 95%;
                    background-color: rgb(255, 255, 255);
                    border: 1px solid #ccc;
                    z-index: 0;
                    margin: 0 auto 0 auto;
                    margin-top: 20px;
                    -webkit-border-radius: 10px;
                    -moz-border-radius: 5px;
                    border-radius: 5px;

                    -webkit-box-shadow: 0px 5px 15px 0px rgba(0, 0, 0, 0.20);
                    -moz-box-shadow:    0px 5px 15px 0px rgba(0, 0, 0, 0.20);
                    box-shadow:          0px 5px 15px 0px rgba(0, 0, 0, 0.20);
                    padding: 20px;
                    margin-bottom: 20px;

                }

                .col1{
                    text-align: left;
                    width: 10%
                }
                .col2{
                    text-align: left;
                    width: 10%

                }
                .fondoColumna1{
                    background-color: #953b39;
                    font-weight: bold;
                    color: white;
                }

                .ui-datalist-item{
                    margin-top: 5px;
                    padding: 5px;
                }


                .btnPlus {
                    background-image: url('#{resource['img/plus.png']}');
                    width: 64px;
                }
                .ui-widget-content {
                    border: 0px solid #444444;
                }

                .ui-panelgrid .ui-panelgrid-cell {
                    border-width: 1px;
                    border-style: solid;
                    border-color: #bbb;

                }

                .ui-datatable tbody td {
                    border-color: #bbb;
                }

                div[id="formEdit:growl_container"] {
                    position:absolute;
                    top:40%;
                    left:40%;
                }
            </style>


            <h:form id="formEdit">
                <p:growl id="growl" life="3000" autoUpdate="true"/>

                <p:panel>
                    <f:facet name="header" class="header"> 
                        <div style="text-align: left;">
                            Nuevo Proyecto
                        </div>
                    </f:facet>

                    <table>
                        <tr>
                            <td valign="bottom" align="left" width="50%">
                                <p:button value="Atras" outcome="List">
                                </p:button>


                            </td>
                            <td valign="bottom" align="right" width="50%">
                                <p:commandButton value="Guardar"  action="#{proyectoController.guardar()}" update="@(.mensajes)"/>
                            </td>
                        </tr>
                    </table>

                </p:panel>


                <div class="hoja">

                    <h:panelGroup>

                        <h2>INFORMACIÓN DEL PROYECTO</h2>
                        <p:separator/>
                        <br/>
                        <p:focus/>
                        <p:panelGrid style="width: 100%">
                            <p:row>
                                <p:column style="width: 15%; height: 40px;" class="fondoColumna1">
                                    <h:outputText value="Nro Expediente"/>
                                </p:column>
                                
                                <p:column style="width: 35%;font-weight: bold;">
                                    <p:inputText value="#{proyectoController.selected.proyectosnroexpediente}" style="font-weight: bold" required="true" requiredMessage="DEBE completar Nro de Expediente!"
                                                 id="nroExpediente">
                                        <f:validator validatorId="validadorNroExpediente"/>
                                        <p:ajax event="blur" update="nroExpediente" process="nroExpediente"/>
                                    </p:inputText>
                                </p:column>

                                <p:column style="width: 15%" class="fondoColumna1">
                                    <h:outputText value="Iniciativa"/>
                                </p:column>

                                <p:column style="width: 35%">
                                    <p:selectOneMenu value="#{proyectoController.selected.proyectosiniciativa}">
                                        <f:selectItem itemLabel="Seleccione una Iniciativa" itemValue=""/>
                                        <f:selectItem itemLabel="Poder Legislativo" itemValue="Poder Legislativo"/>
                                        <f:selectItem itemLabel="Poder Judicial" itemValue="Poder Judicial"/>
                                        <f:selectItem itemLabel="Poder Ejecutivo" itemValue="Poder Ejecutivo"/>
                                        <f:selectItem itemLabel="Popular" itemValue="Popular"/>
                                    </p:selectOneMenu>
                                </p:column>
                            </p:row>

                            <p:row>
                                <p:column  style="font-weight: bold;height: 40px" class="fondoColumna1"><h:outputText value="Acápite"/></p:column>
                                <p:column colspan="3" style="font-weight: bold;">
                                    <h:inputTextarea value="#{proyectoController.selected.proyectosnombre}"  rows="4" style="width: 99%;padding: 5px;font-weight: bold"
                                                     required="true" requiredMessage="El Acápite DEBE completarse">
                                        <p:ajax process="@this" update="@this"/>
                                    </h:inputTextarea>
                                </p:column>
                            </p:row>

                            <p:row>
                                <p:column  style="font-weight: bold;height: 40px" class="fondoColumna1"><h:outputText value="Texto Original"/></p:column>
                                <p:column  style="font-weight: bold;">

                                    <p:panel id="panelTextoOriginal" style="width: 100%">
                                        <table>
                                            <tr>
                                                <td valign="bottom">
                                                    <h:outputText value="No Disponible" rendered="#{(proyectoController.selected.proyectosrutatexto1 == null or proyectoController.selected.proyectosrutatexto1.length() == 0)}"/>


                                                    <p:outputPanel rendered="#{not (proyectoController.selected.proyectosrutatexto1 == null or proyectoController.selected.proyectosrutatexto1.length() == 0)}">

                                                        <a target="_blank" href="${initParam.serverDir}DownloadServlet?nombre=#{proyectoController.selected.proyectosrutatexto1}">
                                                            <div>
                                                                <table>
                                                                    <tr>
                                                                        <td valign="middle">
                                                                            <img src="#{resource['img/file.png']}"/>
                                                                        </td>
                                                                        <td valign="middle">
                                                                            VER
                                                                        </td>
                                                                    </tr>
                                                                </table>
                                                            </div>
                                                        </a>

                                                    </p:outputPanel>
                                                </td>

                                                <td valign="top" style="padding-left: 20px">
                                                    <p:commandButton value="Subir" action="#{proyectoController.generarNombreArchivoOrignal()}"
                                                                     update="panelDisplayOriginal"
                                                                     oncomplete="PF('dialogoArchivoOriginal').show();"/>
                                                </td>
                                            </tr>
                                        </table>



                                        <p:dialog widgetVar="dialogoArchivoOriginal" style="width: 600px;">
                                            <p:panel id="panelDisplayOriginal">
                                                <iframe src="${initParam.serverDir}?nombre=#{proyectoController.nombreArchivoOriginal}" width="100%" height="100%" style="border: none; overflow: hidden">

                                                </iframe>
                                                <p:commandButton value="Hecho" action="#{proyectoController.guardaNombreArchivoOriginal()}" oncomplete="PF('dialogoArchivoOriginal').hide();"
                                                                 update="panelTextoOriginal"/>
                                            </p:panel>
                                        </p:dialog>

                                    </p:panel>


                                </p:column>

                                <p:column  style="font-weight: bold;height: 40px" class="fondoColumna1"><h:outputText value="Fecha Ficta"/></p:column>
                                <p:column colspan="3" style="font-weight: bold;">
                                    <h:outputText value="#{proyectoController.selected.proyectosfechaficta}">
                                        <f:convertDateTime locale="#{formato.locale}" pattern="#{formato.patronFecha}" timeZone="America/Asuncion"/>
                                    </h:outputText>
                                </p:column>
                            </p:row>





                            <p:row>
                                <p:column  style="font-weight: bold;height: 40px" class="fondoColumna1"><h:outputText value="Objetivos"/></p:column>
                                <p:column colspan="3" style="font-weight: bold;">

                                    <p:outputPanel style="padding: 0px!important;" styleClass="panelObjetivos">

                                        <table width="100%" style="margin: 0;padding: 0">
                                            <tr>
                                                <td width="100%">
                                                    <h:inputTextarea value="#{proyectoController.objetivoNuevo.descripcion}" style="font-weight: bold; width: 90%;padding: 5px" cols="2" id="nuevoObjetivo"/>
                                                    <p:watermark for="nuevoObjetivo" value="Ingrese un nuevo objetivo."/>
                                                </td>
                                                <td align="center">
                                                    <p:commandLink action="#{proyectoController.addObjetivo()}" update="@(.panelObjetivos)" onfocus="this.children[0].setAttribute('src', '#{resource['img/plus_green.png']}')"
                                                                   onblur="this.children[0].setAttribute('src', '#{resource['img/plus.png']}')">
                                                        <img src="#{resource['img/plus.png']}" width='32' height='32' onmouseover="this.setAttribute('src', '#{resource['img/plus_green.png']}');"
                                                             onmouseout="this.setAttribute('src', '#{resource['img/plus.png']}');"/>
                                                    </p:commandLink>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td colspan="2">
                                                    <p:separator style="margin-bottom: 5px; margin-top: 5px"/>
                                                </td>
                                            </tr>
                                            <ui:repeat value="#{proyectoController.selected.objetivos}" var="o">
                                                <tr>
                                                    <td width="100%">
                                                        <h:inputTextarea value="#{o.descripcion}" style="font-weight: bold; width: 90%;padding: 5px" cols="3"/><br/>
                                                    </td>
                                                    <td align="center">
                                                        <p:commandLink value="X" action="#{proyectoController.remueveObjetivo(o)}" update="@(.panelObjetivos)"/>
                                                    </td>
                                                </tr>
                                            </ui:repeat>
                                        </table>

                                    </p:outputPanel>

                                </p:column>
                            </p:row>

                        </p:panelGrid>

                        <br/>
                        <h2>TRÁMITES</h2>
                        <p:separator/>
                        <br/>
                        <br/>

                        <p:outputPanel id="panelNuevo">


                            <p:panelGrid style="width: 100%">

                                <p:row>
                                    <p:column style="height: 40px;width: 15%;text-align: center" class="fondoColumna1"><h:outputText value="Sesión"/></p:column>
                                    <p:column style="height: 40px;width: 15%;text-align: center" class="fondoColumna1"><h:outputText value="Fecha"/></p:column>
                                    <p:column style="height: 40px;width: 25%;text-align: center" class="fondoColumna1"><h:outputText value="Etapa"/></p:column>
                                    <p:column style="height: 40px;width: 40%" class="fondoColumna1"><h:outputText value="Resultado"/></p:column>
                                    <p:column style="height: 40px;" class="fondoColumna1"></p:column>
                                </p:row>

                                <p:row>
                                    <p:column style="text-align: center">
                                        <p:inputText value="#{proyectoController.tramiteNuevo.sesion}" id="nuevoSesion"/>
                                    </p:column>
                                    <p:column style="text-align: center">
                                        <p:calendar locale="es" pattern="#{formato.patronFecha}" value="#{proyectoController.tramiteNuevo.fecha}"/>
                                    </p:column>
                                    <p:column style="text-align: center">
                                        <p:outputPanel>
                                            <h:panelGrid columns="1" style="width: 100%; text-align: center">
                                                <p:selectOneMenu var="#{proyectoController.tramiteNuevo.camara}">
                                                    <p:ajax event="change" process="@this panelResultado" update="panelResultado"
                                                            listener="#{proyectoController.cambiaCamara}"/>
                                                    <f:selectItem itemLabel="CAMARA DE DIPUTADOS" itemValue="CAMARA DE DIPUTADOS"/>
                                                    <f:selectItem itemLabel="CAMARA DE SENADORES" itemValue="CAMARA DE SENADORES"/>
                                                </p:selectOneMenu>

                                                <p:inputText value="#{proyectoController.tramiteNuevo.titulo}" placeholder="Ej.: Primer trámite Constitucional" style="width: 95%;"/>
                                                <p:separator style="margin-top: 5px; margin-bottom: 5px;"/>
                                                <p:inputText value="#{proyectoController.tramiteNuevo.subtitulo}" placeholder="Ej.: Ingreso de Expediente" style="width: 95%;"/>
                                            </h:panelGrid>
                                        </p:outputPanel>
                                    </p:column>
                                    <p:column style="vertical-align: top">
                                        <p:outputPanel style="vertical-align: top">
                                            <h:panelGrid columns="2">
                                                <h:outputText value="Tipo: "/>
                                                <p:selectOneMenu value="#{proyectoController.tramiteNuevo.tipoResultado}">
                                                    <p:ajax event="change" process="@this panelResultado" update="panelResultado"
                                                            listener="#{proyectoController.subjectSelectionChanged}"/>
                                                    <f:selectItems value="#{productorEnums.obtTiposResultados()}"/>
                                                </p:selectOneMenu>
                                            </h:panelGrid>

                                            <p:panel id="panelResultado" styleClass="panelResultado">
                                                <p:outputPanel id="panelComision" rendered="#{proyectoController.tramiteNuevo.tipoResultado == 'GIRADO_A'}" style="border: none">
                                                    Girado a:
                                                    <p:autoComplete value="#{proyectoController.comisionElegida}"  size="35" 
                                                                    id="autoCompleteComision"
                                                                    completeMethod="#{autoCompleteComision.completar}" widgetVar="autoCompleteComision"
                                                                    forceSelection="true" converter="comisionConverter" var="c" itemValue="#{c}" itemLabel="#{c.nombre}">

                                                        <p:ajax event="itemSelect" update="panelResultado" listener="#{proyectoController.addComision()}"
                                                                oncomplete="$(function(){PrimeFaces.focus('formEdit:autoCompleteComision');});"/>

                                                    </p:autoComplete>

                                                    <p:dataGrid value="#{proyectoController.tramiteNuevo.comisiones}" var="c" columns="1">

                                                        <div style="width: 100%">
                                                            <div style="float: left;vertical-align: top">
                                                                <h:outputText value="#{c.nombre}"/>
                                                            </div>
                                                            <div style="float: right">
                                                                <p:commandLink value="X" action="#{proyectoController.quitarComision(c)}"
                                                                               update="@(.panelResultado)"
                                                                               oncomplete="$(function(){PrimeFaces.focus('formEdit:autoCompleteComision');});"/>
                                                            </div>

                                                        </div>


                                                    </p:dataGrid>



                                                </p:outputPanel>


                                                <p:outputPanel id="panelDictamenComision" rendered="#{proyectoController.tramiteNuevo.tipoResultado == 'DICTAMEN_COMISION'}" styleClass="panelDictamenComision">
                                                    <p:autoComplete value="#{proyectoController.tramiteNuevo.comisionDictamen}" size="35"
                                                                    completeMethod="#{autoCompleteComision.completar}"
                                                                    forceSelection="true" converter="comisionConverter" var="c" itemValue="#{c}" itemLabel="#{c.nombre}">


                                                    </p:autoComplete>
                                                    <p:separator style="margin-top: 5px;margin-bottom: 5px"/>
                                                    SENTIDO:
                                                    <h:selectOneMenu value="#{proyectoController.tramiteNuevo.resultado}">
                                                        <f:selectItem itemLabel="APRUEBA" itemValue="APRUEBA"/>
                                                        <f:selectItem itemLabel="RECHAZA" itemValue="RECHAZA"/>
                                                        <f:selectItem itemLabel="MODIFICA" itemValue="MODIFICA"/>
                                                        <f:selectItem itemLabel="OTRA MODIFICACIÓN" itemValue="OTRA MODIFICACION"/>
                                                    </h:selectOneMenu>
                                                </p:outputPanel>

                                                <p:outputPanel id="panelDictamen" rendered="#{proyectoController.tramiteNuevo.tipoResultado == 'TEXTO_DICTAMEN'}" styleClass="panelDictamen">
                                                    <p:autoComplete value="#{proyectoController.tramiteNuevo.comisionDictamen}" size="35"
                                                                    completeMethod="#{autoCompleteComision.completar}"
                                                                    id="autoCompleteComisionDictamen"
                                                                    forceSelection="true" converter="comisionConverter" var="c" itemValue="#{c}" itemLabel="#{c.nombre}">


                                                        <p:ajax event="itemSelect" update="panelResultado"
                                                                oncomplete="$(function(){PrimeFaces.focus('formEdit:autoCompleteComisionDictamen');});"/>

                                                    </p:autoComplete>



                                                    <p:commandButton value="Subir" action="#{proyectoController.generarNombreArchivo()}"
                                                                     update="panelDisplayDictamen"
                                                                     oncomplete="PF('dialogoArchivoDictamen').show();"/>

                                                    <p:dialog widgetVar="dialogoArchivoDictamen" style="width: 600px;">
                                                        <p:panel id="panelDisplayDictamen">
                                                            <iframe src="${initParam.serverDir}?nombre=#{proyectoController.nombreArchivo}" width="100%" height="100%" style="border: none; overflow: hidden">

                                                            </iframe>
                                                            <p:commandButton value="Hecho" action="#{proyectoController.guardaNombreArchivo()}" oncomplete="PF('dialogoArchivoDictamen').hide();"
                                                                             update="panelResultado"/>
                                                        </p:panel>
                                                    </p:dialog>

                                                    <p:panel rendered="#{not (empty proyectoController.tramiteNuevo.resultadoLink or proyectoController.tramiteNuevo.resultadoLink == null)}">
                                                        <a href="${initParam.serverDir}DownloadServlet?nombre=#{proyectoController.tramiteNuevo.resultadoLink}">
                                                            <div>
                                                                <table>
                                                                    <tr>
                                                                        <td valign="middle">
                                                                            <img src="#{resource['img/file.png']}"/>
                                                                        </td>
                                                                        <td valign="middle">
                                                                            #{proyectoController.tramiteNuevo.comisionDictamen.nombre}
                                                                        </td>
                                                                    </tr>
                                                                </table>

                                                            </div>

                                                        </a>
                                                    </p:panel>
                                                    <p:panel rendered="#{(proyectoController.tramiteNuevo.comisionDictamen != null and proyectoController.tramiteNuevo.resultadoLink == null)}">
                                                        #{proyectoController.tramiteNuevo.comisionDictamen.nombre}
                                                    </p:panel>

                                                </p:outputPanel>
                                                <p:outputPanel id="panelSancion" rendered="#{(proyectoController.tramiteNuevo.tipoResultado == 'TEXTO_MEDIA_SANCION'
                                                                                             or proyectoController.tramiteNuevo.tipoResultado == 'TEXTO_SANCION' 
                                                                                             or proyectoController.tramiteNuevo.tipoResultado == 'VETO_TOTAL_CO' 
                                                                                             or proyectoController.tramiteNuevo.tipoResultado == 'VETO_TOTAL_CR' 
                                                                                             or proyectoController.tramiteNuevo.tipoResultado == 'VETO_PARCIAL_CO' 
                                                                                             or proyectoController.tramiteNuevo.tipoResultado == 'VETO_PARCIAL_CR' 
                                                                                             or proyectoController.tramiteNuevo.tipoResultado == 'TEXTO_APROBADO_CM')}">



                                                    <p:commandButton value="Subir" action="#{proyectoController.generarNombreArchivo()}"
                                                                     update="panelDisplaySancion"
                                                                     oncomplete="PF('dialogoArchivoSancion').show();"/>

                                                    <p:dialog widgetVar="dialogoArchivoSancion" style="width: 600px;">
                                                        <p:panel id="panelDisplaySancion">
                                                            <iframe src="${initParam.serverDir}?nombre=#{proyectoController.nombreArchivo}" width="100%" height="100%" style="border: none; overflow: hidden">

                                                            </iframe>
                                                            <p:commandButton value="Hecho" action="#{proyectoController.guardaNombreArchivo()}" oncomplete="PF('dialogoArchivoSancion').hide();"
                                                                             update="panelResultado"/>
                                                        </p:panel>
                                                    </p:dialog>


                                                    <p:panel rendered="#{not (empty proyectoController.tramiteNuevo.resultadoLink or proyectoController.tramiteNuevo.resultadoLink == null)}">
                                                        <a href="${initParam.serverDir}DownloadServlet?nombre=#{proyectoController.tramiteNuevo.resultadoLink}">
                                                            <div>
                                                                <table>
                                                                    <tr>
                                                                        <td valign="middle">
                                                                            <img src="#{resource['img/file.png']}"/>
                                                                        </td>
                                                                        <td valign="middle">
                                                                            #{proyectoController.tramiteNuevo.tipoResultado}
                                                                        </td>
                                                                    </tr>
                                                                </table>
                                                            </div>
                                                        </a>
                                                    </p:panel>


                                                </p:outputPanel>

                                                <p:outputPanel id="panelOtro" rendered="#{proyectoController.tramiteNuevo.tipoResultado == 'OTRO'}">
                                                    <p:inputTextarea cols="50" rows="3" placeholder="Ej.: POSTERGARDO .. "
                                                                     value="#{proyectoController.tramiteNuevo.resultado}"/>
                                                </p:outputPanel>
                                            </p:panel>




                                        </p:outputPanel>

                                    </p:column>
                                    <p:column style="height: 40px;">
                                        <p:commandLink action="#{proyectoController.addTramite()}" update="tramites panelNuevo" 
                                                       oncomplete="$(function(){PrimeFaces.focus('formEdit:nuevoSesion');});"
                                                       onfocus="this.children[0].setAttribute('src', '#{resource['img/plus_green.png']}')"
                                                       onblur="this.children[0].setAttribute('src', '#{resource['img/plus.png']}')">
                                            <img src="#{resource['img/plus.png']}" width='48' height='48' onmouseover="this.setAttribute('src', '#{resource['img/plus_green.png']}');"
                                                 onmouseout="this.setAttribute('src', '#{resource['img/plus.png']}');"/>
                                        </p:commandLink>

                                    </p:column>
                                </p:row>


                            </p:panelGrid>

                        </p:outputPanel>



                        <p:dataTable id="tramites" value="#{proyectoController.selected.tramites}" var="t">
                            <p:column style="width: 20px; text-align: center">
                                <p:commandLink  action="#{proyectoController.toogleEditTramite(t)}"
                                                update="tramites">
                                    <img src="#{resource['img/edit.png']}"/>
                                </p:commandLink>
                            </p:column>
                            <p:column headerText="Sesión" style="text-align: center; width: 13%">
                                <h:outputText value="#{t.sesion}" rendered="#{not t.editar}"/>
                                <p:inputText value="#{t.sesion}" rendered="#{t.editar}"/>
                            </p:column>
                            <p:column headerText="Fecha" style="text-align: center; width: 13%">
                                <h:outputText value="#{t.fecha}" rendered="#{not t.editar}">
                                    <f:convertDateTime locale="#{formato.locale}" pattern="#{formato.patronFecha}"/>
                                </h:outputText>
                                <p:calendar locale="es" pattern="#{formato.patronFecha}" value="#{t.fecha}" rendered="#{t.editar}"/>
                            </p:column>
                            <p:column headerText="Etapa" style="text-align: center">
                                <h:panelGroup style="text-align: center">

                                    <p:selectOneMenu var="#{t.camara}" rendered="#{t.editar}">
                                        <p:ajax event="change" process="@this @(.tpanelResultado)" update="@(.tpanelResultado)"
                                                listener="#{proyectoController.cambiaCamara}"/>
                                        <f:selectItem itemLabel="CAMARA DE DIPUTADOS" itemValue="CAMARA DE DIPUTADOS"/>
                                        <f:selectItem itemLabel="CAMARA DE SENADORES" itemValue="CAMARA DE SENADORES"/>
                                    </p:selectOneMenu>

                                    <p:outputPanel rendered="#{(t.camara == 'CAMARA DE SENADORES' and (not t.editar))}">
                                        <div style="background-color: #F6D8CE;-webkit-border-radius: 3px;
                                             -moz-border-radius: 3px;
                                             border-radius: 3px; width: 60%;padding: 3px;border: 1px solid red;text-align: center; margin: 0 auto 0 auto;">
                                            <h:outputText value="#{t.camara}" style="font-weight: bold;color:red; "/>  
                                        </div>
                                    </p:outputPanel>
                                    <p:outputPanel rendered="#{(t.camara == 'CAMARA DE DIPUTADOS' and (not t.editar))}">
                                        <div style="background-color: #CEE3F6;-webkit-border-radius: 3px;
                                             -moz-border-radius: 3px;
                                             border-radius: 3px; width: 60%;padding: 3px;border: 1px solid #0044cc;text-align: center; margin: 0 auto 0 auto;">
                                            <h:outputText value="#{t.camara}" style="font-weight: bold;color:#0044cc; "/>  
                                        </div>
                                    </p:outputPanel>


                                    <br/>
                                    <h:outputText value="#{t.titulo}" style="font-weight: bold" rendered="#{not t.editar}"/>
                                    <p:inputText value="#{t.titulo}" style="font-weight: bold;width: 90%" rendered="#{t.editar}"/>
                                    <p:separator style="margin-top: 5px; margin-bottom: 5px;"/>
                                    <h:outputText value="#{t.subtitulo}" style="font-weight: bold; font-style: italic;color: #888" rendered="#{not t.editar}"/>
                                    <p:inputText value="#{t.subtitulo}" style="font-weight: bold; font-style: italic;color: #888; width: 90%" rendered="#{t.editar}"/>

                                </h:panelGroup>

                            </p:column>
                            <p:column headerText="Resultado">

                                <p:panel id="tpanelResultado" styleClass="tpanelResultado" rendered="#{t.editar}">
                                    <p:outputPanel rendered="#{t.tipoResultado == 'GIRADO_A'}" style="border: none">
                                        Girado a:
                                        <p:autoComplete value="#{t.comisionElegida}"  size="40" 
                                                        id="tautoCompleteComision"
                                                        completeMethod="#{autoCompleteComision.completar}" widgetVar="tautoCompleteComision"
                                                        forceSelection="true" converter="comisionConverter" var="c" itemValue="#{c}" itemLabel="#{c.nombre}">

                                            <p:ajax event="itemSelect" update="@(.tpanelResultado)" listener="#{t.addComision()}"
                                                    oncomplete="$(function(){PrimeFaces.focus('formEdit:tautoCompleteComision');});"/>

                                        </p:autoComplete>

                                        <p:dataGrid value="#{t.comisiones}" var="c" columns="1">

                                            <div style="width: 100%">
                                                <div style="float: left;vertical-align: top">
                                                    <h:outputText value="#{c.nombre}"/>
                                                </div>
                                                <div style="float: right">
                                                    <p:commandLink value="X" action="#{t.quitarComision(c)}"
                                                                   update="@(.tpanelResultado)"
                                                                   oncomplete="$(function(){PrimeFaces.focus('formEdit:tautoCompleteComision');});"/>
                                                </div>

                                            </div>
                                        </p:dataGrid>



                                    </p:outputPanel>


                                    <p:outputPanel  rendered="#{t.tipoResultado == 'DICTAMEN_COMISION'}" styleClass="tpanelDictamenComision">
                                        <p:autoComplete value="#{t.comisionDictamen}" size="35"
                                                        completeMethod="#{autoCompleteComision.completar}"
                                                        forceSelection="true" converter="comisionConverter" var="c" itemValue="#{c}" itemLabel="#{c.nombre}">


                                        </p:autoComplete>
                                        <p:separator style="margin-top: 5px;margin-bottom: 5px"/>
                                        SENTIDO:
                                        <h:selectOneMenu value="#{t.resultado}">
                                            <f:selectItem itemLabel="APRUEBA" itemValue="APRUEBA"/>
                                            <f:selectItem itemLabel="RECHAZA" itemValue="RECHAZA"/>
                                            <f:selectItem itemLabel="MODIFICA" itemValue="MODIFICA"/>
                                            <f:selectItem itemLabel="OTRA MODIFICACIÓN" itemValue="OTRA MODIFICACION"/>
                                        </h:selectOneMenu>
                                    </p:outputPanel>

                                    <p:outputPanel  rendered="#{t.tipoResultado == 'TEXTO_DICTAMEN'}" styleClass="tpanelDictamen">

                                        <p:panel styleClass="tpanelResultado">
                                            <p:autoComplete value="#{t.comisionDictamen}" size="35"
                                                            completeMethod="#{autoCompleteComision.completar}"
                                                            id="tautoCompleteComisionDictamen"
                                                            forceSelection="true" converter="comisionConverter" var="c" itemValue="#{c}" itemLabel="#{c.nombre}">


                                                <p:ajax event="itemSelect" update="@(.tpanelResultado)"
                                                        oncomplete="$(function(){PrimeFaces.focus('formEdit:tautoCompleteComisionDictamen');});"/>

                                            </p:autoComplete>



                                            <p:commandButton value="Subir" action="#{t.generarNombreArchivo()}"
                                                             update="@(.tpanelDisplayDictamen)"
                                                             oncomplete="PF('tdialogoArchivoDictamen').show();"/>

                                            <p:dialog widgetVar="tdialogoArchivoDictamen" style="width: 600px;">
                                                <p:panel id="tpanelDisplayDictamen" styleClass="tpanelDisplayDictamen">
                                                    <iframe src="${initParam.serverDir}?nombre=#{t.nombreArchivo}" width="100%" height="100%" style="border: none; overflow: hidden">

                                                    </iframe>
                                                    <p:commandButton value="Hecho" action="#{t.guardaNombreArchivo()}" oncomplete="PF('tdialogoArchivoDictamen').hide();"
                                                                     update="@(.tpanelResultado)"/>
                                                </p:panel>
                                            </p:dialog>

                                            <p:panel rendered="#{not (empty t.resultadoLink or t.resultadoLink == null)}">
                                                <a href="${initParam.serverDir}DownloadServlet?nombre=#{t.resultadoLink}">
                                                    <div style="width: 100%; display: inline">

                                                        <div style="float: left;text-align: left;">
                                                            <img src="#{resource['img/file.png']}"/>
                                                        </div>

                                                        <div style="float: right;text-align: left;position: relative;top: 50%">
                                                            <h:outputText value="#{t.comisionDictamen.nombre}" style="position: relative;top: 50%"/>
                                                        </div>


                                                    </div>

                                                </a>
                                            </p:panel>
                                            <p:panel rendered="#{(t.comisionDictamen != null and t.resultadoLink == null)}">
                                                #{proyectoController.tramiteNuevo.comisionDictamen.nombre}
                                            </p:panel>

                                        </p:panel>

                                    </p:outputPanel>
                                    <p:outputPanel  rendered="#{(t.tipoResultado == 'TEXTO_MEDIA_SANCION'
                                                                or t.tipoResultado == 'TEXTO_SANCION' 
                                                                or t.tipoResultado == 'VETO_TOTAL_CO' 
                                                                or t.tipoResultado == 'VETO_TOTAL_CR' 
                                                                or t.tipoResultado == 'VETO_PARCIAL_CO' 
                                                                or t.tipoResultado == 'VETO_PARCIAL_CR' 
                                                                or t.tipoResultado == 'TEXTO_APROBADO_CM')}">



                                        <p:panel styleClass="tpanelResultadoArchivo">

                                            <p:commandButton value="Subir" action="#{t.generarNombreArchivo()}"
                                                             update="@(.tpanelDisplaySancion)"
                                                             oncomplete="PF('tdialogoArchivoSancion').show();"/>

                                            <p:dialog widgetVar="tdialogoArchivoSancion" style="width: 600px;">
                                                <p:panel  styleClass="tpanelDisplaySancion">
                                                    <iframe src="${initParam.serverDir}?nombre=#{t.nombreArchivo}" width="100%" height="100%" style="border: none; overflow: hidden">

                                                    </iframe>
                                                    <p:commandButton value="Hecho" action="#{t.guardaNombreArchivo()}" oncomplete="PF('tdialogoArchivoSancion').hide();"
                                                                     update="@(.tpanelResultadoArchivo)"/>
                                                </p:panel>
                                            </p:dialog>


                                            <p:panel rendered="#{not (empty t.resultadoLink or t.resultadoLink == null)}">
                                                <a href="${initParam.serverDir}DownloadServlet?nombre=#{t.resultadoLink}">
                                                    <div style="width: 100%; display: inline">

                                                        <div style="float: left;text-align: left;">
                                                            <img src="#{resource['img/file.png']}"/>
                                                        </div>
                                                        <div style="float: right;text-align: left;position: relative;top: 50%">
                                                            <h:outputText value="#{t.tipoResultado}" style="position: relative;top: 50%"/>
                                                        </div>
                                                    </div>
                                                </a>
                                            </p:panel>


                                        </p:panel>



                                    </p:outputPanel>

                                    <p:outputPanel id="panelOtro" rendered="#{t.tipoResultado == 'OTRO'}">
                                        <p:inputTextarea cols="50" rows="3" placeholder="Ej.: POSTERGARDO .. "
                                                         value="#{t.resultado}"/>
                                    </p:outputPanel>
                                </p:panel>

                                <p:panel rendered="#{not t.editar}">
                                    <p:outputPanel  rendered="#{t.tipoResultado == 'GIRADO_A'}" style="border: none">
                                        <p:panelGrid columns="1">
                                            <h:outputText value="PASA A COMISIÓN:"/>

                                            <h:panelGroup>
                                                <ul style="list-style-type: circle; padding: 15px;margin-left: 15px">
                                                    <ui:repeat value="#{t.comisiones}" var="c">
                                                        <li style="margin-bottom: 3px">#{c.nombre}</li>
                                                    </ui:repeat>
                                                </ul>
                                            </h:panelGroup>

                                        </p:panelGrid>
                                    </p:outputPanel>
                                    <p:outputPanel  rendered="#{t.tipoResultado == 'DICTAMEN_COMISION'}" styleClass="panelDictamenComision">
                                        <h:outputText value="#{t.comisionDictamen.nombre}" style="font-weight: bold"/>
                                        <p:separator style="margin-top: 5px; margin-bottom: 5px;"/>
                                        <h:outputText value="SENTIDO: #{t.resultado}"/>
                                    </p:outputPanel>
                                    <p:outputPanel  rendered="#{t.tipoResultado == 'TEXTO_DICTAMEN'}" styleClass="panelDictamen">
                                        <a href="${initParam.serverDir}DownloadServlet?nombre=#{t.resultadoLink}">
                                            <div>
                                                <table style="border-width: 0px">
                                                    <tr style="border-width: 0px">
                                                        <td valign="middle" style="border-width: 0px" width="10%">
                                                            <img src="#{resource['img/file.png']}"/>
                                                        </td>
                                                        <td valign="middle" style="border-width: 0px" width="90%" align="left">
                                                            #{t.comisionDictamen.nombre}
                                                        </td>
                                                    </tr>
                                                </table>
                                            </div>
                                        </a>
                                    </p:outputPanel>
                                    <p:outputPanel  rendered="#{(t.tipoResultado == 'TEXTO_MEDIA_SANCION'
                                                                or t.tipoResultado == 'TEXTO_SANCION' 
                                                                or t.tipoResultado == 'VETO_TOTAL_CO' 
                                                                or t.tipoResultado == 'VETO_TOTAL_CR' 
                                                                or t.tipoResultado == 'VETO_PARCIAL_CO' 
                                                                or t.tipoResultado == 'VETO_PARCIAL_CR' 
                                                                or t.tipoResultado == 'TEXTO_APROBADO_CM')}">
                                        <a href="${initParam.serverDir}DownloadServlet?nombre=#{t.resultadoLink}">
                                            <div>
                                                <table style="border-width: 0px">
                                                    <tr style="border-width: 0px">
                                                        <td valign="middle" style="border-width: 0px" width="10%">
                                                            <img src="#{resource['img/file.png']}"/>
                                                        </td>
                                                        <td valign="middle" style="border-width: 0px" width="90%" align="left">
                                                            #{t.tipoResultado}
                                                        </td>
                                                    </tr>
                                                </table>
                                            </div>
                                        </a>
                                    </p:outputPanel>
                                    <p:outputPanel  rendered="#{t.tipoResultado == 'OTRO'}">
                                        <h:outputText value="#{t.resultado}"/>
                                    </p:outputPanel>
                                </p:panel>

                            </p:column>
                            <p:column style="width: 20px; text-align: center">
                                <p:commandLink value="X" style="font-size: 18pt" action="#{proyectoController.quitarTramite(t)}"
                                               update="tramites"/>
                            </p:column>
                        </p:dataTable>

                    </h:panelGroup>

                </div>

            </h:form>


        </ui:define>
    </ui:composition>

</html>
